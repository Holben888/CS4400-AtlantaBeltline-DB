<main>
  <div class="content-container">
    <svelte:component this="{currPageComponent}" />
  </div>
</main>

<style>
  main {
    width: 100%;
    display: flex;
    justify-content: center;
  }
  .content-container {
    width: 100%;
    max-width: 60rem;
  }
</style>

<script>
  import { onMount, onDestroy } from 'svelte'
  import Login from './login.html'
  import Dashboard from './dashboard.html'
  import AdminUserMngr from './admin/user-mngr.html'
  import Register from './register.html'
  import { pageStore } from './store'

  let currPageComponent = Dashboard

  const pages = [
    {
      path: '/',
      component: Dashboard,
    },
    {
      path: '/login',
      component: Login,
    },
    {
      path: '/admin-user-mngr',
      component: AdminUserMngr,
    },
    {
      path: '/register',
      component: Register,
    },
  ]

  onMount(() => pageStore.set(location.pathname))

  const unsubscribe = pageStore.subscribe(path => {
    const matchingPage = pages.find(page => page.path === path)
    if (matchingPage) {
      currPageComponent = matchingPage.component
    }
  })

  onDestroy(() => unsubscribe())
</script>
