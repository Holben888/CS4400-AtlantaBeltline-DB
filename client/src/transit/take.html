<h1>Take a Transit</h1>

<Table
  data="{tableData}"
  sortEndpoint="/transit"
  setData="{setData}"
  selected="{transitSelected}"
  selectItem="{selectTransit}"
  headers="{tableHeaders}"
></Table>

<form id="logTransit" on:submit|preventDefault="{logTransit}">
  <input type="date" name="date" />
  <button class="general-button" onclick="log()" style="margin-left: 20px;">
    Log Transit
  </button>
</form>

<script>
  import Table from '../shared/table.html'
  import fetch from '../fetch'
  import { onMount } from 'svelte'

  let tableData = []
  const tableHeaders = ['Route', 'Type', 'Price', '# Connected Sites']
  let transitSelected = -1
  let sortParams = {}

  onMount(async () => {
    const response = await fetch('/transit')
    if (response && response.transits) tableData = response.transits
  })

  const setData = newData => {
    if (newData.transits) tableData = newData.transits
  }

  const logTransit = () => {
    const date = document.forms['logTransit']['date'].value
    //log transit
  }

  const selectTransit = item => (transitsSelected = item)
</script>
